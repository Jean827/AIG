import pandas as pd
import os

# 确保目录存在
directory = os.path.dirname('/Users/Data/Cloud/AIG/Projects/AKS/development_tasks.xlsx')
if not os.path.exists(directory):
    os.makedirs(directory)

# 创建功能开发清单数据
tasks = []

# 1. 业务管理PC端 - 基本信息管理
tasks.extend([
    {'功能ID': 'PC-BASIC-001', '功能名称': '乡镇基础信息录入', '所属模块': '基本信息管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '1', '描述': '录入乡镇名称、乡镇编号、土地面积、村组数量、所属机构信息', '状态': '待开发'},
    {'功能ID': 'PC-BASIC-002', '功能名称': '乡镇基础信息编辑', '所属模块': '基本信息管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '1', '描述': '编辑和修改已有乡镇信息', '状态': '待开发'},
    {'功能ID': 'PC-BASIC-003', '功能名称': '村队基础信息录入', '所属模块': '基本信息管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '1', '描述': '录入所属乡镇、乡镇编号、村队名称、村队编号、村队土地面积等', '状态': '待开发'},
    {'功能ID': 'PC-BASIC-004', '功能名称': '村队基础信息编辑', '所属模块': '基本信息管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '1', '描述': '编辑和修改已有村队信息', '状态': '待开发'},
    {'功能ID': 'PC-BASIC-005', '功能名称': '种植户信息录入', '所属模块': '基本信息管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '1', '描述': '录入种植户卡号、姓名、乡镇名称、村组名称、证件号码、农户类别、联系方式等', '状态': '待开发'},
    {'功能ID': 'PC-BASIC-006', '功能名称': '种植户信息编辑', '所属模块': '基本信息管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '1', '描述': '编辑和修改已有种植户信息', '状态': '待开发'}
])

# 2. 业务管理PC端 - 土地基础信息
tasks.extend([
    {'功能ID': 'PC-LAND-001', '功能名称': '地类单价设置录入', '所属模块': '土地基础信息', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '1', '描述': '通过地类等级、单价、生产年度、所属机构设置地类单价', '状态': '待开发'},
    {'功能ID': 'PC-LAND-002', '功能名称': '地类单价设置编辑', '所属模块': '土地基础信息', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '1', '描述': '编辑和修改已有地类单价设置', '状态': '待开发'},
    {'功能ID': 'PC-LAND-003', '功能名称': '土地基础信息录入', '所属模块': '土地基础信息', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '1', '描述': '录入地块编号、地块名称所属乡镇、土地总面积、土地等级等信息', '状态': '待开发'},
    {'功能ID': 'PC-LAND-004', '功能名称': '土地基础信息编辑', '所属模块': '土地基础信息', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '1', '描述': '编辑和修改已有地块信息', '状态': '待开发'}
])

# 3. 业务管理PC端 - 账户业务管理
tasks.extend([
    {'功能ID': 'PC-ACCOUNT-001', '功能名称': '充值明细查询', '所属模块': '账户业务管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '1', '描述': '通过单据号或者证件号码等信息查询种植户的充值金额和时间等信息', '状态': '待开发'},
    {'功能ID': 'PC-ACCOUNT-002', '功能名称': '充值作废与冲正', '所属模块': '账户业务管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '1', '描述': '对充值记录进行作废、冲正操作', '状态': '待开发'},
    {'功能ID': 'PC-ACCOUNT-003', '功能名称': '票据补打', '所属模块': '账户业务管理', '所属系统': '业务管理PC端', '优先级': '中', '实施阶段': '1', '描述': '补打充值票据', '状态': '待开发'},
    {'功能ID': 'PC-ACCOUNT-004', '功能名称': '保证金转账户余额', '所属模块': '账户业务管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '2', '描述': '将保证金转为账户余额', '状态': '待开发'},
    {'功能ID': 'PC-ACCOUNT-005', '功能名称': '账户信息查询', '所属模块': '账户业务管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '1', '描述': '通过账号、农户姓名或证件号码查询种植户账户余额', '状态': '待开发'},
    {'功能ID': 'PC-ACCOUNT-006', '功能名称': '种植户账户充值', '所属模块': '账户业务管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '1', '描述': '给种植户进行充值操作', '状态': '待开发'},
    {'功能ID': 'PC-ACCOUNT-007', '功能名称': '支出明细查询', '所属模块': '账户业务管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '1', '描述': '通过支出单号、账号或者证件号码查询种植户的费用支出情况', '状态': '待开发'}
])

# 4. 业务管理PC端 - 土地竞拍管理
tasks.extend([
    {'功能ID': 'PC-AUCTION-001', '功能名称': '承包户注册流程', '所属模块': '土地竞拍管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '2', '描述': '承包户注册、资质审核、保证金缴纳、竞拍参与、中标缴费/未中标退款流程', '状态': '待开发'},
    {'功能ID': 'PC-AUCTION-002', '功能名称': '管理员审核流程', '所属模块': '土地竞拍管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '2', '描述': '审核用户资质、发布土地信息、管理竞拍流程、处理违约及重新发包', '状态': '待开发'},
    {'功能ID': 'PC-AUCTION-003', '功能名称': '审核业务', '所属模块': '土地竞拍管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '2', '描述': '审核承包户资质，审核通过后用户可查看土地信息', '状态': '待开发'},
    {'功能ID': 'PC-AUCTION-004', '功能名称': '信息发布', '所属模块': '土地竞拍管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '2', '描述': '管理员发布土地承包信息，包括土地面积、单价、起拍价、竞标时间等', '状态': '待开发'},
    {'功能ID': 'PC-AUCTION-005', '功能名称': '保证金业务', '所属模块': '土地竞拍管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '2', '描述': '承包户缴纳保证金参与竞拍，未中标自动退款', '状态': '待开发'},
    {'功能ID': 'PC-AUCTION-006', '功能名称': '竞拍业务', '所属模块': '土地竞拍管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '2', '描述': '实时竞拍系统，最高价者得，处理并发出价情况', '状态': '待开发'},
    {'功能ID': 'PC-AUCTION-007', '功能名称': '中标缴费业务', '所属模块': '土地竞拍管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '2', '描述': '中标者缴纳承包费，否则扣除保证金', '状态': '待开发'}
])

# 5. 业务管理PC端 - 承包合同管理
tasks.extend([
    {'功能ID': 'PC-CONTRACT-001', '功能名称': '承包信息查询', '所属模块': '承包合同管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '2', '描述': '通过乡镇名称、村组名称、一卡通号、农户姓名、身份证号码等查询承包信息', '状态': '待开发'},
    {'功能ID': 'PC-CONTRACT-002', '功能名称': '承包信息审核确认', '所属模块': '承包合同管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '2', '描述': '有权限用户审核确认承包信息', '状态': '待开发'},
    {'功能ID': 'PC-CONTRACT-003', '功能名称': '承包信息作废', '所属模块': '承包合同管理', '所属系统': '业务管理PC端', '优先级': '中', '实施阶段': '2', '描述': '有权限用户作废承包信息', '状态': '待开发'},
    {'功能ID': 'PC-CONTRACT-004', '功能名称': '承包信息费用生成', '所属模块': '承包合同管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '2', '描述': '选择费用年度，生成承包年度费用', '状态': '待开发'},
    {'功能ID': 'PC-CONTRACT-005', '功能名称': '承包明细查询', '所属模块': '承包合同管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '2', '描述': '通过乡镇名称、村组名称、承包编号等查询承包明细', '状态': '待开发'}
])

# 6. 业务管理PC端 - 费用信息管理
tasks.extend([
    {'功能ID': 'PC-FEE-001', '功能名称': '核减信息审核', '所属模块': '费用信息管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '2', '描述': '审核收费员提交的核减申请', '状态': '待开发'},
    {'功能ID': 'PC-FEE-002', '功能名称': '费用信息查询', '所属模块': '费用信息管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '2', '描述': '通过缴费状态、乡镇名称、村组名称、费用编号等查询费用信息', '状态': '待开发'},
    {'功能ID': 'PC-FEE-003', '功能名称': '费用核减申请', '所属模块': '费用信息管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '2', '描述': '填写核减金额和原因，提交核减申请', '状态': '待开发'},
    {'功能ID': 'PC-FEE-004', '功能名称': '费用明细查询', '所属模块': '费用信息管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '2', '描述': '查询费用编号、乡镇名称、村组名称、农户姓名等费用明细', '状态': '待开发'}
])

# 7. 业务管理PC端 - 收费信息管理
tasks.extend([
    {'功能ID': 'PC-PAYMENT-001', '功能名称': '收费信息查询', '所属模块': '收费信息管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '2', '描述': '通过乡镇名称、村组名称、缴费状态等查询需要缴费的农户信息', '状态': '待开发'},
    {'功能ID': 'PC-PAYMENT-002', '功能名称': '缴费操作', '所属模块': '收费信息管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '2', '描述': '输入缴费人姓名、电话、支付方式及金额进行缴费', '状态': '待开发'},
    {'功能ID': 'PC-PAYMENT-003', '功能名称': '已缴费信息查询', '所属模块': '收费信息管理', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '2', '描述': '查询已缴费的信息', '状态': '待开发'},
    {'功能ID': 'PC-PAYMENT-004', '功能名称': '收费信息作废', '所属模块': '收费信息管理', '所属系统': '业务管理PC端', '优先级': '中', '实施阶段': '2', '描述': '作废错误的收费信息', '状态': '待开发'},
    {'功能ID': 'PC-PAYMENT-005', '功能名称': '收费票据补打', '所属模块': '收费信息管理', '所属系统': '业务管理PC端', '优先级': '中', '实施阶段': '2', '描述': '补打收费票据', '状态': '待开发'}
])

# 8. 业务管理PC端 - 融资与确权管理
tasks.extend([
    {'功能ID': 'PC-FINANCE-001', '功能名称': '划拨土地数字化入库', '所属模块': '融资与确权管理', '所属系统': '业务管理PC端', '优先级': '中', '实施阶段': '3', '描述': '对国家划拨的土地资产进行信息核验、数据录入和数字化建档', '状态': '待开发'},
    {'功能ID': 'PC-FINANCE-002', '功能名称': 'GIS可视化落图', '所属模块': '融资与确权管理', '所属系统': '业务管理PC端', '优先级': '中', '实施阶段': '3', '描述': '将划拨地块在GIS地图上进行精准落图和特殊标识', '状态': '待开发'},
    {'功能ID': 'PC-FINANCE-003', '功能名称': '融资项目立项', '所属模块': '融资与确权管理', '所属系统': '业务管理PC端', '优先级': '中', '实施阶段': '3', '描述': '线上创建融资项目，关联目标地块，上传并管理项目文档', '状态': '待开发'},
    {'功能ID': 'PC-FINANCE-004', '功能名称': '融资过程节点追踪', '所属模块': '融资与确权管理', '所属系统': '业务管理PC端', '优先级': '中', '实施阶段': '3', '描述': '对融资关键节点进行线上流程化追踪与管理', '状态': '待开发'},
    {'功能ID': 'PC-FINANCE-005', '功能名称': '融资台账管理', '所属模块': '融资与确权管理', '所属系统': '业务管理PC端', '优先级': '中', '实施阶段': '3', '描述': '自动生成融资台账，动态更新各地块的融资信息', '状态': '待开发'},
    {'功能ID': 'PC-FINANCE-006', '功能名称': '确权任务生成与派发', '所属模块': '融资与确权管理', '所属系统': '业务管理PC端', '优先级': '中', '实施阶段': '3', '描述': '融资成功后自动触发土地确权任务并派发', '状态': '待开发'},
    {'功能ID': 'PC-FINANCE-007', '功能名称': '确权进度可视化追踪', '所属模块': '融资与确权管理', '所属系统': '业务管理PC端', '优先级': '中', '实施阶段': '3', '描述': '对确权环节进行线上跟踪与督办', '状态': '待开发'},
    {'功能ID': 'PC-FINANCE-008', '功能名称': '权证数字化管理', '所属模块': '融资与确权管理', '所属系统': '业务管理PC端', '优先级': '中', '实施阶段': '3', '描述': '对土地权证进行扫描、存档和数字化管理', '状态': '待开发'},
    {'功能ID': 'PC-FINANCE-009', '功能名称': '资金流向监控', '所属模块': '融资与确权管理', '所属系统': '业务管理PC端', '优先级': '中', '实施阶段': '3', '描述': '建立融资资金使用台账，记录资金支出情况', '状态': '待开发'},
    {'功能ID': 'PC-FINANCE-010', '功能名称': '还款与解押预警', '所属模块': '融资与确权管理', '所属系统': '业务管理PC端', '优先级': '中', '实施阶段': '3', '描述': '提前对即将到期的还款任务进行预警，触发解押流程提醒', '状态': '待开发'}
])

# 9. 业务管理PC端 - 系统管理子系统
tasks.extend([
    {'功能ID': 'PC-SYS-001', '功能名称': '菜单管理', '所属模块': '系统管理子系统', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '1', '描述': '菜单名称新增、修改、删除，图标选择，类型选择，地址编辑，顺序编排等', '状态': '待开发'},
    {'功能ID': 'PC-SYS-002', '功能名称': '乡镇机构管理', '所属模块': '系统管理子系统', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '1', '描述': '录入土地管理公司信息，可进行启用、停用、删除等操作', '状态': '待开发'},
    {'功能ID': 'PC-SYS-003', '功能名称': '用户管理', '所属模块': '系统管理子系统', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '1', '描述': '用户录入、编辑、密码重置、激活用户等', '状态': '待开发'},
    {'功能ID': 'PC-SYS-004', '功能名称': '角色管理', '所属模块': '系统管理子系统', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '1', '描述': '角色录入、编辑、权限设置等', '状态': '待开发'},
    {'功能ID': 'PC-SYS-005', '功能名称': '组织机构管理', '所属模块': '系统管理子系统', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '1', '描述': '组织机构录入、编辑、角色设置等', '状态': '待开发'},
    {'功能ID': 'PC-SYS-006', '功能名称': '数据字典管理', '所属模块': '系统管理子系统', '所属系统': '业务管理PC端', '优先级': '高', '实施阶段': '1', '描述': '字典分类录入、编辑等', '状态': '待开发'}
])

# 10. 土地竞拍对外网站
tasks.extend([
    {'功能ID': 'WEB-AUCTION-001', '功能名称': '公共土地信息展示', '所属模块': '土地竞拍网站', '所属系统': '土地竞拍对外网站', '优先级': '高', '实施阶段': '2', '描述': '展示可竞拍土地的详细信息', '状态': '待开发'},
    {'功能ID': 'WEB-AUCTION-002', '功能名称': '竞拍公告发布', '所属模块': '土地竞拍网站', '所属系统': '土地竞拍对外网站', '优先级': '高', '实施阶段': '2', '描述': '发布竞拍通知和结果', '状态': '待开发'},
    {'功能ID': 'WEB-AUCTION-003', '功能名称': '在线注册', '所属模块': '土地竞拍网站', '所属系统': '土地竞拍对外网站', '优先级': '高', '实施阶段': '2', '描述': '允许农户注册和参与竞拍', '状态': '待开发'},
    {'功能ID': 'WEB-AUCTION-004', '功能名称': '竞拍流程管理', '所属模块': '土地竞拍网站', '所属系统': '土地竞拍对外网站', '优先级': '高', '实施阶段': '2', '描述': '在线管理整个竞拍流程', '状态': '待开发'}
])

# 11. 手机APP端
tasks.extend([
    {'功能ID': 'APP-001', '功能名称': '田间巡检', '所属模块': '手机APP', '所属系统': '手机APP端', '优先级': '中', '实施阶段': '3', '描述': '支持田间巡检和数据采集', '状态': '待开发'},
    {'功能ID': 'APP-002', '功能名称': '审批管理', '所属模块': '手机APP', '所属系统': '手机APP端', '优先级': '高', '实施阶段': '3', '描述': '允许管理人员在移动端审批请求', '状态': '待开发'},
    {'功能ID': 'APP-003', '功能名称': '数据查询', '所属模块': '手机APP', '所属系统': '手机APP端', '优先级': '高', '实施阶段': '3', '描述': '快速访问关键数据和报告', '状态': '待开发'},
    {'功能ID': 'APP-004', '功能名称': '通知中心', '所属模块': '手机APP', '所属系统': '手机APP端', '优先级': '高', '实施阶段': '3', '描述': '推送重要通知和提醒', '状态': '待开发'}
])

# 12. 微信小程序端
tasks.extend([
    {'功能ID': 'MINI-001', '功能名称': '农户自助服务', '所属模块': '微信小程序', '所属系统': '微信小程序端', '优先级': '高', '实施阶段': '2', '描述': '允许农户管理账户和支付', '状态': '待开发'},
    {'功能ID': 'MINI-002', '功能名称': '在线竞拍参与', '所属模块': '微信小程序', '所属系统': '微信小程序端', '优先级': '高', '实施阶段': '2', '描述': '允许农户通过移动端参与竞拍', '状态': '待开发'},
    {'功能ID': 'MINI-003', '功能名称': '信息查询', '所属模块': '微信小程序', '所属系统': '微信小程序端', '优先级': '高', '实施阶段': '2', '描述': '提供土地和合同信息查询', '状态': '待开发'},
    {'功能ID': 'MINI-004', '功能名称': '支付处理', '所属模块': '微信小程序', '所属系统': '微信小程序端', '优先级': '高', '实施阶段': '2', '描述': '支持在线支付费用和保证金', '状态': '待开发'}
])

# 13. POS机端
tasks.extend([
    {'功能ID': 'POS-001', '功能名称': '支付处理', '所属模块': 'POS机端', '所属系统': 'POS机端', '优先级': '高', '实施阶段': '3', '描述': '通过POS机处理支付', '状态': '待开发'},
    {'功能ID': 'POS-002', '功能名称': '票据打印', '所属模块': 'POS机端', '所属系统': 'POS机端', '优先级': '高', '实施阶段': '3', '描述': '自动打印支付票据', '状态': '待开发'},
    {'功能ID': 'POS-003', '功能名称': '交易同步', '所属模块': 'POS机端', '所属系统': 'POS机端', '优先级': '高', '实施阶段': '3', '描述': '与主系统同步交易', '状态': '待开发'},
    {'功能ID': 'POS-004', '功能名称': '离线操作', '所属模块': 'POS机端', '所属系统': 'POS机端', '优先级': '中', '实施阶段': '3', '描述': '支持有限的离线操作能力', '状态': '待开发'}
])

# 14. 大屏端
tasks.extend([
    {'功能ID': 'SCREEN-001', '功能名称': '数据可视化', '所属模块': '大屏端', '所属系统': '大屏端', '优先级': '中', '实施阶段': '3', '描述': '关键绩效指标的可视化展示', '状态': '待开发'},
    {'功能ID': 'SCREEN-002', '功能名称': '实时监控', '所属模块': '大屏端', '所属系统': '大屏端', '优先级': '中', '实施阶段': '3', '描述': '系统状态和操作的实时监控', '状态': '待开发'},
    {'功能ID': 'SCREEN-003', '功能名称': '决策支持', '所属模块': '大屏端', '所属系统': '大屏端', '优先级': '中', '实施阶段': '3', '描述': '为管理决策提供数据支持', '状态': '待开发'},
    {'功能ID': 'SCREEN-004', '功能名称': '可定制仪表盘', '所属模块': '大屏端', '所属系统': '大屏端', '优先级': '中', '实施阶段': '3', '描述': '支持为不同角色定制仪表盘', '状态': '待开发'}
])

# 创建DataFrame并导出为Excel
df = pd.DataFrame(tasks)

try:
    # 尝试直接保存
    df.to_excel('/Users/Data/Cloud/AIG/Projects/AKS/development_tasks.xlsx', index=False)
    print("Excel文件创建成功！")
except Exception as e:
    # 如果失败，尝试保存为CSV
    df.to_csv('/Users/Data/Cloud/AIG/Projects/AKS/development_tasks.csv', index=False, encoding='utf-8-sig')
    print(f"Excel文件创建失败，已创建CSV文件：{e}")